<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>第12羽「転職は僕の決定的瞬間」 - 純粋関数空間</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="../css/bootstrap-responsive.min.css" rel="stylesheet" media="screen">
    <link href="../css/default.css" rel="stylesheet" media="screen">
    <link href="../css/syntax.css" rel="stylesheet" media="screen">
    <link href="../css/docs.css" rel="stylesheet" media="screen">

    <script type="text/javascript" src="http://s.hatena.ne.jp/js/HatenaStar.js"></script>
    <script type="text/javascript">
        Hatena.Star.Token = '448676af7a3fe5b6511e9789fbaed5a26da61054';
        Hatena.Star.SiteConfig = {
            entryNodes: {
                '.post-title': {
                    uri: 'document.location',
                    title: 'document.title',
                    container: 'parent'
                }
            }
        };
    </script>
  </head>
  <body>
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="../js/bootstrap.min.js"></script>

    <div class="container-fluid">
        <div class="navbar">
            <div class="navbar-inner">
                <a class="brand" href="../">tanakh.jp</a>

                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>

                <div class="nav-collapse">
                    <ul class="nav">
                        <li><a href="../">Home</a></li>
                        <li><a href="../about.html">About</a></li>
                        <li><a href="../contact.html">Contact</a></li>
                        <li><a href="../pub.html">Publications</a></li>
                        <li><a href="../tools.html">Tools</a></li>
                        <li><a href="../archive.html">Archive</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row-fluid">
            <div class="span2"></div>
            <div class="span8">
                <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/ja_JP/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<h2 class="post-title">第12羽「転職は僕の決定的瞬間」</h2>

<p>
  <div class="info">Posted on December 25, 2015, Tags: <a href="../tags/others.html">others</a></div>
</p>

<!-- Social Buttons -->
<div class="social">
    <div class="hatena">
        <a href="http://b.hatena.ne.jp/entry/tanakh.jp/posts/2015-12-25-gochiusa.html" class="hatena-bookmark-button" data-hatena-bookmark-title="第12羽「転職は僕の決定的瞬間」 - tanakh.jp" data-hatena-bookmark-layout="standard-balloon" title="このエントリーをはてなブックマークに追加"><img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="http://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
    </div>
    <div class="facebook">
        <div class="fb-like" data-href="http://tanakh.jp/posts/2015-12-25-gochiusa.html" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false" data-font="arial"></div>
    </div>
    <div class="gplus">
        <!-- +1 ボタン を表示したい位置に次のタグを貼り付けてください。 -->
        <div class="g-plusone" data-size="medium" data-href="http://tanakh.jp/posts/2015-12-25-gochiusa.html"></div>
        <!-- 最後の +1 ボタン タグの後に次のタグを貼り付けてください。 -->
        <script type="text/javascript">
          (function() {
            var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
            po.src = 'https://apis.google.com/js/plusone.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
          })();
        </script>
    </div>
    <div class="twitter">
        <a href="https://twitter.com/share" class="twitter-share-button" data-via="tanakh" data-lang="ja">ツイート</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    </div>
</div>

<hr>

<div class="post-content">
<p>これは<a href="http://gochiusa.connpass.com/event/22058/">ごちうさ Advent Calendar 2015</a>の25日目の記事です。ごちうさ二期の最終回後の未来から書いています。</p>
<h1 id="転職しました">転職しました</h1>
<div class="figure">
<img src="../img/posts/tenshoku.png" />

</div>
<p>僕のTwitterをご覧になっている方はご存知かもしれませんが、ワケあって、前職を辞めて、今年の九月から<a href="http://www.pezy.co.jp/">株式会社PEZY Computing</a>で働いております。</p>
<p>どういう会社なのかよく知らない人も多いと思いますので、簡単に説明しますと、超メニーコアのプロセッサを作っていて、それを搭載するボードとか、それを液浸冷却するシステムとかを作る関連会社があったりして、スパコンとして仕立て上げたりしているような、そんな会社です。なんか積層メモリ作ってる関連会社もあるみたいです。えっ、そんな会社が日本にあるの？って思われるかもしれませんが、実在している会社ですし、実際にモノもできているからたぶん本当にあります。</p>
<p>僕がPEZYのことを初めて知ったのはちょうど去年の今頃の、「いろいろ」あってつらい状況にあるときでした。その時に<a href="https://twitter.com/nushio">@nushio</a>さんがすごく心配してくれて、誕生日やらなにやらを祝ってくれたりしたのですが、そのときに、こんな「ヤバい」会社があるでっていうことで教えてくれたのがここでした。</p>
<p>なにやら独自のアーキテクチャと独自の命令セットで超メニーコアのプロセッサを作っていて、それでスパコンまで作ってるっていう話で、めっちゃ熱く語ってくれるんですけど、にわかには信じがたい話ではあるので、マジでそんな会社あんの？全く聞いたことないんだけど、本当に存在してるの？ていうか、プロセッサってそんなさくっと作れるものなの？作れるのだとしたらなんで世のプロセッサメーカーはあんなに苦戦しているの？もっとそういうメーカーがないとおかしくない？とまあおそらく極めてごくあたりまえな疑問がいくつも浮かんだわけです。</p>
<p>なんでかは知らん。ただ、それらはプロセッサを作るのがとても大変な仕事で、設計には長期間を要して、たくさんの人的リソースが必要だ、ということに対する状況証拠に過ぎないわけだし、日和ってしまって試行すらされないだけなのではないのか？、という話ではある。なるほどそれは確かにそうだが、そんなことを言うだけならいくらでも言えるわけで、もうちょい現実味がある話が欲しい。じゃあまあとにかく見学に行くべきだ。自分も明日行く予定だから、一緒にでも。</p>
<p>帰る前に、一通りどういうプロセッサなのかを熱心に語ってくれて、SIMD要素のない1024コアの純粋なMIMDプロセッサで、それぞれのコアはさらにシンプルなスケジューリングのSMTでストールを隠蔽するようになっていて、さらにSMTのスレッドには明示的に切り替える裏と表があって、メモリアクセスなどの長時間のストール時に手動でそれを切り替えてそれを隠蔽する手段を提供しているだとか、キャッシュが用意されているから、一見普通のプログラムがそれなりに動くんだけど、複雑さを減らすためにキャッシュのコヒーレンシを保つ仕組みは何もなくて、Raceを避けるのはすべてプログラマ任せだったりだとか、2次元、3次元の配列にキャッシュ効率よくアクセスするためのZオーダーインデックスの計算が1命令でできるような命令があったりとか、ともかくすごくオリジナリティーあふれるもので。</p>
<p>だけれども、個人的には非常に理にかなった設計には思えて、例えば今のGPGPUでは密な行列の演算以外を十分に効率よく行うのはかなり難しいと思うし、かといってIntelのメニーコアのようなアプローチでは、結局のところGPUに匹敵するFLOPSを確保するには全くコアが足りないので、その分だけSIMD長を伸ばすしかない。しかしSIMD長が長くなるということはその分いびつな形のデータにはやはりフィットしなくなるということになる。理論性能を多くのアプリでうまく引き出せるには、やはり完全なMIMDのほうが望ましいはずなんだ。そのために制御部分を大量に入れ込むために、チューニングの多くの責任をプログラミングに投げてしまって、コア部分をなるべくシンプルにする。プログラマが死ぬほど頑張れば、性能は出るはず。理にはかなっている。そしてコンパイラ技術がそういう状況をさらに後押しできるはずだし、そうなると自分の力が助けになるのではなかろうか…？</p>
<p>というそんなこんなで、見学に行くことになったわけですが。そのとき彼が家に残して行ったのが「エクサスケールの衝撃」という、PEZY社の社長が書いた本なのですが、この内容がこれまたやばい。</p>
<div class="amazlet-box" style="margin-bottom:0px;">
<div class="amazlet-image" style="float:left;margin:0px 12px 1px 0px;">
<a href="http://www.amazon.co.jp/exec/obidos/ASIN/4569818927/peropero0b-22/ref=nosim/" name="amazletlink" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51bpmfT3RaL._SL160_.jpg" alt="エクサスケールの衝撃" style="border: none;" /></a>
</div>
<div class="amazlet-info" style="line-height:120%; margin-bottom: 10px">
<div class="amazlet-name" style="margin-bottom:10px;line-height:120%">
<a href="http://www.amazon.co.jp/exec/obidos/ASIN/4569818927/peropero0b-22/ref=nosim/" name="amazletlink" target="_blank">エクサスケールの衝撃</a>
<div class="amazlet-powered-date" style="font-size:80%;margin-top:5px;line-height:120%">
posted with <a href="http://www.amazlet.com/" title="amazlet" target="_blank">amazlet</a> at 16.01.01
</div>
</div>
<div class="amazlet-detail">
齊藤 元章 <br />PHP研究所 <br />売り上げランキング: 4,466<br />
</div>
<div class="amazlet-sub-info" style="float: left;">
<div class="amazlet-link" style="margin-top: 5px">
<a href="http://www.amazon.co.jp/exec/obidos/ASIN/4569818927/peropero0b-22/ref=nosim/" name="amazletlink" target="_blank">Amazon.co.jpで詳細を見る</a>
</div>
</div>
</div>
<div class="amazlet-footer" style="clear: left">

</div>
</div>
<p>どこがどうやばいのかというと、目次を見ればだいたい察することはできると思うのですが、相当にエキセントリックな、ややもすれば「妄想」としか言いようのないことがみっしりと書き記されていて、しかしながら明確におかしなことが書いてあるわけではなさそうで、個人的にはこういうのは好きだし、理解はできるけど、えっマジで言ってるの？っていうそういう意味での如何わしさはさらに増した感はあったわけです。</p>
<p>それはともかく見学に行ってみると、そこは普通のビルの一室で、傍目にはとてもではないがそんなとんでもないものを作っているようには見えないし、従業員もそんな多くなさそうで、いたって普通のベンチャーといった感じではあったのですが、高そうなFPGAボードがあったり、カット前のシリコンウエハーが置いてあったりして、こういうレベルでプロセッサ作ってる会社がマジであるのかあと驚きつつも、その時はそのまま帰って、なんだか悶々と考えていました。すごく面白そうなことをしているとは思うのだけど、本当に大丈夫なんだろうか。どうなんだろうなあ、うーん、うーん、などなどと。</p>
<p>そうこう考えているうちになんだかんだあって、なんだかんだしていたのはそのころのブログを見ていただくとわかると思うのですが、その間もあの時アプローチしていたらとか悶々と考えることもあって、それからさらになんだかんだあって、ちょうどそのころに<a href="http://pc.watch.impress.co.jp/docs/news/20150803_714768.html">PEZYがGreen500でTop1,2,3を独占した</a>とのニュースが出て、マジか、マジでできたんか。なるほど僕の直感も多少はあてにはなるものだと、あれだけ疑わしく思っていた自分を棚に上げて感心しきりで、それで改めてアプローチをさせていただいたところ、なんだか全くよくわからないうちに二つ返事で入社が決まり、入社が決まったその日のうちに和光の理研に連れていかれて、Shoubu（和光に設置してあるGreen500でトップを取ったマシンです）を見学しつつプログラムをデバッグしている様子を見守ることになって、この会社アグレッシブすぎるだろう…などと思ったのでありました。</p>
<p>そういうわけで九月から頑張って働いております。ちょうど四か月になりますが、すでにかなりいろいろやらせてもらっていて、なかでも入って二か月ぐらいのときに、SC15のブース出展のためにアメリカ出張が入ったのがなかなか刺激的でした。去年、一昨年あたりの僕のブログとかを見ていただくとわかると思うのですが、結構体調面で無理がきかないところがあったのですが、今年に入っておおよそ大丈夫になったということで、こういう仕事もこなせるようになったというのは、ひとつ大きな喜びではあります。</p>
<p>それに日常的に社長の無茶ぶりレベルがかなり高くて、nushioさんからどういう風に僕のことを紹介されたのかと言いたくなるような、「できる？できない？できる？やっちゃお！」を地で行くようなことをよく言われるのですが、期待をかけられるのはそれ自体はありがたい話ですし、多少無茶なことを言われたほうが、自分も無茶なことをしでかすような気がするので、それはそれで楽しかったりします。</p>
<p>仕事内容は、これは毎日刺激に満ちていて、とても楽しいし、こんなことしてお金がもらえるなんて、自分は幸せ者だなあとかそんな風に思うぐらいやりたいこととかみ合ってるような気がしています。ちょっとありえないレベルのメモリと演算性能を、使いたいと思えばいつでも使える環境にあるのは、プログラマ冥利につきるわけだし、じゃじゃ馬のようなプロセッサをうまく乗りこなそうと頑張ったり、あるいはどういうプログラミングモデルを載せれば、プログラマに対して難しい部分を隠せるのだろうかとウンウン考えてみたりとか、もともと言語処理系方面を研究したかった自分にはやっと多少なりともそのあたりが活かせそうな仕事ができそうです。入社当時の僕のツイートをご覧になっていた方は、ことあるごとに「最近、プログラミングが好きだ。」などと頻繁にツイートしていたのを覚えていらっしゃるかもしれません。</p>
<h1 id="ごちうさはいいぞ">ごちうさはいいぞ</h1>
<p>さて、ごちうさの話です。こっちが本編なのかな？</p>
<p>待ちに待ったごちうさの二期が始まり、そしてあっという間に終わって行ってしまいました。終わってしまったのは悲しいけれど、週に一度、30分の至福の時間をくれたごちうさには本当に感謝です。</p>
<p>二期を観て、あらためてごちうさの可愛さは群を抜いているなあと思ったわけですが、何がその要因なのか、これがまた、なかなかに難しい問題です。ほかの類似のアニメと比べると、世界設定がずいぶんと異なるというところがあります。たいていはこういうのは同級生の女子高生、女子中学生が数人で何かするという形になっているのですが、ごちうさはメインのキャラクターがそれぞれ別の学校に通っていますし、どちらかといえば女の子ありきというよりも、木組みの街があって、そこに住むチノちゃんと、迷い込んだココアさんを中心とした、一つの街のお話といった印象を受けます。現代日本と違う、架空のとてもかわいらしい街はそれ自体で一つの非日常であり、非日常的な風景には俗世から切り離された、絵画や芸術を思わせる情緒があります。非日常に迷い込んだ少女とうさぎの話、これは一つの不思議の国のアリスの可能性ともいえるでしょう。そういったファンタジーをにおわせることで、作品世界ごとかわいさを一つ上のレベルに持ち上げることに成功したのがごちうさであり、まさにその非日常の中の日常というものが、ある種のかわいいに対する最適解を構成するための有望なアプローチであるということが、これによって示唆されるわけです。</p>
<p>と、そんなことはわりとどうでもよくて、こんなことを考えなくても、ごちうさがとてもかわいいのは誰しも映像を観れば一目瞭然になっているのです。とてもかわいい。とても安らぐ。幸せな気分だ。気持ちが軽くなった気がする。明日への活力が満ちてくる。またごちうさを観るためにがんばらなければなあ。</p>
<p>昨年の春にごちうさが始まってから、僕は再就職を果たし、ゆっくりながら以前の生活を取り戻しつつあります。薬の量もかなり減って、今ではレクサプロ10mg/dayのみです。頓服の抗不安剤もありません。そのおかげか、脳の働きを抑制されているという感覚もずいぶん和らいできました。ある程度集中してものを考えらえるようになったのは、プログラマとしては相当の改善です。本当にうれしいことです。</p>
<p>よくごちうさなどのアニメを「向精神アニメ」などという人がいます。実際にそういう効果があるのかどうかは定かではありませんが、ごちうさに救われたと感じている人間が少なくともここに一人おります。ごちうさを見た後は本当に幸せでほっこりやさしい気持ちになれるし、ささくれた僕の心にも、多少の人間としての心が住み着いていたのだということを再認識させてくれるのです。人並みの幸せを追い求めたいという気持ちがもこもこと心の奥底から湧き上がってくるのです。</p>
<p>ポイッて今日を投げださない約束しましょう、から始まるごちうさはまさに前向きな人生を歩むための指針であります。3か月の至福のときはあっという間に過ぎ去ってしまいましたが、僕はこれからもなんとかやって行けそうです。12回も約束をしたわけですからね。そして願わくば、3期でまた元気なラビットハウスの面々に会えますように。</p>
</div>

<br>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-2554934724722249";
/* normal */
google_ad_slot = "6131209617";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

<br>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'tanakh-jp'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'tanakh-jp'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>

            </div>
            <div class="span2"></div>
        </div>

        <hr>

        <footer class="footer">
            <center>
            <p>
                Copyright (c) 2011-2015, Hideyuki Tanaka (@<a href="https://twitter.com/tanakh">tanakh</a>)
            </p>
            <p>
                Site proudly generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>.<br>
                Served by <a href="http://mew.org/~kazu/proj/mighttpd/en/">Mighttpd2</a>.<br>
                Tools are made with <a href="http://fay-lang.org/">Fay</a>.<br>
                This site uses <a href="http://twitter.github.io/bootstrap/">Twitter Bootstrap</a>, and theme from <a href="http://bootswatch.com/">Bootswatch</a>.<br>
            <p>
            </center>
        </footer>
    </div>

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-26679036-1']);
      _gaq.push(['_setDomainName', 'tanakh.jp']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

  </body>
</html>
