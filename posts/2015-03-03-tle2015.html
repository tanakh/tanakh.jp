<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>TLE 2015 - 純粋関数空間</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="../css/bootstrap-responsive.min.css" rel="stylesheet" media="screen">
    <link href="../css/default.css" rel="stylesheet" media="screen">
    <link href="../css/syntax.css" rel="stylesheet" media="screen">
    <link href="../css/docs.css" rel="stylesheet" media="screen">

    <script type="text/javascript" src="http://s.hatena.ne.jp/js/HatenaStar.js"></script>
    <script type="text/javascript">
        Hatena.Star.Token = '448676af7a3fe5b6511e9789fbaed5a26da61054';
        Hatena.Star.SiteConfig = {
            entryNodes: {
                '.post-title': {
                    uri: 'document.location',
                    title: 'document.title',
                    container: 'parent'
                }
            }
        };
    </script>
  </head>
  <body>
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="../js/bootstrap.min.js"></script>

    <div class="container-fluid">
        <div class="navbar">
            <div class="navbar-inner">
                <a class="brand" href="../">tanakh.jp</a>

                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>

                <div class="nav-collapse">
                    <ul class="nav">
                        <li><a href="../">Home</a></li>
                        <li><a href="../about.html">About</a></li>
                        <li><a href="../contact.html">Contact</a></li>
                        <li><a href="../pub.html">Publications</a></li>
                        <li><a href="../tools.html">Tools</a></li>
                        <li><a href="../archive.html">Archive</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row-fluid">
            <div class="span2"></div>
            <div class="span8">
                <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/ja_JP/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<h2 class="post-title">TLE 2015</h2>

<p>
  <div class="info">Posted on March  3, 2015, Tags: <a href="../tags/programming.html">programming</a></div>
</p>

<!-- Social Buttons -->
<div class="social">
    <div class="hatena">
        <a href="http://b.hatena.ne.jp/entry/tanakh.jp/posts/2015-03-03-tle2015.html" class="hatena-bookmark-button" data-hatena-bookmark-title="TLE 2015 - tanakh.jp" data-hatena-bookmark-layout="standard-balloon" title="このエントリーをはてなブックマークに追加"><img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="http://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
    </div>
    <div class="facebook">
        <div class="fb-like" data-href="http://tanakh.jp/posts/2015-03-03-tle2015.html" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false" data-font="arial"></div>
    </div>
    <div class="gplus">
        <!-- +1 ボタン を表示したい位置に次のタグを貼り付けてください。 -->
        <div class="g-plusone" data-size="medium" data-href="http://tanakh.jp/posts/2015-03-03-tle2015.html"></div>
        <!-- 最後の +1 ボタン タグの後に次のタグを貼り付けてください。 -->
        <script type="text/javascript">
          (function() {
            var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
            po.src = 'https://apis.google.com/js/plusone.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
          })();
        </script>
    </div>
    <div class="twitter">
        <a href="https://twitter.com/share" class="twitter-share-button" data-via="tanakh" data-lang="ja">ツイート</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
    </div>
</div>

<hr>

<div class="post-content">
<p>TLE 2015というプログラミングコンテスト <a href="http://felicity.iiit.ac.in/contest/tle/" class="uri">http://felicity.iiit.ac.in/contest/tle/</a> で香風智乃さんが優勝されました。 春休みの宿題の良い息抜きになったそうです。</p>
<p>記事を言付かっておりますので、ここに掲載させていただきます。</p>
<hr />
<h2 id="雑感">雑感</h2>
<p>Twitterにリンクが流れてきたのでやってみたのですが、割と面白かったです。</p>
<h2 id="distinct-substrings">Distinct Substrings</h2>
<p>与えられた文字列に対して相異なる部分文字列の数を数えるだけの問題なのですが、 スコアが「提出したソースコードの異なる部分文字列の数 / 提出したソースコードの長さの2乗」で計算されます。 なんだこの問題…。</p>
<p>適当に書いたコードの後ろにランダムな文字列をくっつけて送ったら、 理論値の0.5に近いスコアが簡単にでたので、そのまま放置です。</p>
<script src="https://gist.github.com/tanakh/0ab56c02028f69e70249.js?file=1.c"></script>
<h2 id="find-the-gcd">Find the GCD</h2>
<p>2000桁ぐらいの整数2つが与えられるのでそのgcdを求める問題でした。 ただし、入力に妙な制約があって、答えは2^16以下の2の累乗になります。</p>
<p>これだけだと普通の問題ですが、追加の制約として、<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code> の文字を使わずに書けというものがあって、 ちょっと面倒だなと思いました。 さらにソースコードが短いほうがスコアが高くなります。苦手なゴルフです。</p>
<p>最初の方はまじめにビット演算で足し算するコードを書いていたのですが、 それでも十分良いスコアがでていたので、放置していました。 しばらくしたらダブルスコアぐらいで負け始めたので、まじめに考え始めました。</p>
<p>よく考えたら、C++なら演算子が使えなくても、 std::plus<int>()で足し算が出来てしまいます。 頑張って縮めたビット演算のコードがごみになってしまいました。</p>
<p>次に、多倍長整数を読み込む部分を、最初一ケタずつ読んで10倍して足すというのを書いていたのですが、 よくよく考えたら、2^16 って 10^16 の約数になるんですね。 まじめに1ケタずつ読む必要なんてなかったわけで、 結局 cin から string で一気に読み込んで、後ろ16ケタぐらいを切り出して、 atol に入れるという残念なコードになりました。</p>
<p>最後に入力の整数の下位ビットの0の数を数えないといけないのですが、 これはgccなら__builtin_ctz()という関数を呼ぶだけです。</p>
<p>結局、std::plus() などの関数も使わないほど単純なコードになりました。 なんだこの問題…。演算子縛りとは。</p>
<script src="https://gist.github.com/tanakh/0ab56c02028f69e70249.js?file=2.cpp"></script>
<h2 id="life-the-universe-and-everything">Life, the Universe and Everything</h2>
<p>一行ごとに整数がやってくるので、それをそのまま出力せよ、ただし42が来たらそこで終了する。 という問題です。これもなるべく短いコードを提出しなければいけません。</p>
<p>ただ、これだけではあまりにも簡単すぎるからかどうかは知りませんが、 この問題ではソースコードが -nostdlib というオプションを付けてコンパイルされます。 なんだこのフラグ…。</p>
<p>どうやらCの標準ライブラリなしでコンパイルされるので、 printfやscanfはおろか、read/writeのシステムコール、main関数呼び出し、 プログラム終了のためのexitシステムコール呼び出しをすべて自力で行わないといけないようです。 実行環境は64ビットLinuxのようでしたが、 64ビットLinuxで動くプログラムをスクラッチで書いた経験がなかったので、 システムコールを自力で呼び出す方法からお勉強です。</p>
<p>いろいろ調べた結果、rax レジスタにシステムコール番号を入れて、 あとは rdx, rsi, rdi などのレジスタに引数を渡してから、 syscallという命令を実行すれば良いことがわかりました。 64bit gccの呼び出し規約で使われるレジスタやその順番がシステムコールのものと違うので、 普通にインラインアセンブリで書くと値を移動するためにコードが増えてしまうので、 呼び出す側でシステムコールの順に引数を渡してやるようにすると、 最終的に、必要な移動は rcx -&gt; rax だけになりました。</p>
<p>初めてでうまくやれるか不安でしたが、 なんとかそこそこの点数が取れました。 あとで聞いた話ですが、入力が固定だったらしく、 出力を止める位置を決め打ちで出来てしまったらしいです。 台無しです…。</p>
<script src="https://gist.github.com/tanakh/0ab56c02028f69e70249.js?file=3.c"></script>
<h2 id="ascii-weaving">ASCII Weaving</h2>
<p>指定されたアスキーアートを、なるべく小さなコードで表示するという問題です。 画像圧縮系はあんまり得意ではないので、 単純なランレングスでお茶を濁すしかありませんでした。 もっと精進しなければ。</p>
<script src="https://gist.github.com/tanakh/0ab56c02028f69e70249.js?file=4.c"></script>
<h2 id="halting">Halting</h2>
<p>プログラムが与えられるので、それが停止するかどうかを判別するという問題です。</p>
<p>プログラムは main 関数ひとつからなっていて、int型の変数を3つ持って、関数呼び出しはなく… など、それっぽいことが書いてあるのですが、肝心の文法の定義がどこにも書いてありません。 セマンティクスの定義もありません。 そもそも与えられたプログラムがCのサブセットだということも書いてません。</p>
<p>ということは、これはプログラムの停止性を判定する問題では無いということですね。 もっとも、一般のプログラムに対する停止性の判定アルゴリズムは存在しないということは あまりにも有名ですが、そのサブセットを書く必要もなさそうです。</p>
<p>ということは、おそらく問題は決め打ちのはず…。 と思ってジャッジに投げながら先頭から順番に解答を確定していこうと思ったのですが、 どうもおかしいです。同じ入力でスコアがかなりバラつきます。 やっぱり決め打ちではないのかな…って思って、 でも全部yesを返した時のスコアは何回やっても同じです。 考えられる理由としては、停止するプログラムと停止しないプログラムの数を決めて、 それぞれ生成しているか、あるいは問題セットが同じでシャッフルされているかぐらいですが、 問題をランダム生成するには、かなり荷が重い問題だと思いますし、 そもそもそれでは誰も解けなくなってしまうので、 やっぱりシャッフルしてるだけだろう、とあたりをつけてやってみると、 あっさり解けてしまいました。</p>
<p>この問題で苦労したのは、どういうわけかわからないのですが、 rand() を呼び出すと問答無用でエラーもなく0点にされてしまうところでした。 これに気づくまで、自分のコードが間違っているのか、方針が間違っているのか、 判断がつかなくて大変でした。</p>
<script src="https://gist.github.com/tanakh/0ab56c02028f69e70249.js?file=5.cpp"></script>
<h2 id="reverse-quine">Reverse Quine</h2>
<p>自分自身を反転したものを、自分自身の長さ回繰り返し出力するプログラムをできるだけ短く書くという問題です。</p>
<p>クワインは苦手です。 それに、順位表を見ていると、クワインのプロの方がいっぱいいらっしゃったので、 これは勝てないだろうなあと思っていました。 すごく苦労しましたが、なんとか正の点数がもらえるコードが完成したので満足です。</p>
<script src="https://gist.github.com/tanakh/0ab56c02028f69e70249.js?file=6.c"></script>
</div>

<br>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-2554934724722249";
/* normal */
google_ad_slot = "6131209617";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

<br>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'tanakh-jp'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'tanakh-jp'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>

            </div>
            <div class="span2"></div>
        </div>

        <hr>

        <footer class="footer">
            <center>
            <p>
                Copyright (c) 2011-2013, Hideyuki Tanaka (@<a href="https://twitter.com/tanakh">tanakh</a>)
            </p>
            <p>
                Site proudly generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>.<br>
                Served by <a href="http://mew.org/~kazu/proj/mighttpd/en/">Mighttpd2</a>.<br>
                Tools are made with <a href="http://fay-lang.org/">Fay</a>.<br>
                This site uses <a href="http://twitter.github.io/bootstrap/">Twitter Bootstrap</a>, and theme from <a href="http://bootswatch.com/">Bootswatch</a>.<br>
            <p>
            </center>
        </footer>
    </div>

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-26679036-1']);
      _gaq.push(['_setDomainName', 'tanakh.jp']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

  </body>
</html>
